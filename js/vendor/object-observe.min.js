Object.observe||function(f,C,v){var k,l,H="add update delete reconfigure setPrototype preventExtensions".split(" "),I=v.Node?function(a){return a&&a instanceof v.Node}:function(a){return a&&"object"===typeof a&&"number"===typeof a.nodeType&&"string"===typeof a.nodeName},J=C.isArray||function(a){return function(c){return"[object Array]"===a.call(c)}}(f.prototype.toString),t=C.prototype.indexOf?function(a,c,b){return c.indexOf(a,b)}:function(a,c,b){for(b=b||0;b<c.length;b++)if(c[b]===a)return b;return-1},
x="undefined"!==typeof v.Map&&Map.prototype.forEach?function(){return new Map}:function(){var a=[],c=[];return{size:0,has:function(b){return-1<t(b,a)},get:function(b){return c[t(b,a)]},set:function(b,d){var e=t(b,a);-1===e?(a.push(b),c.push(d),this.size++):c[e]=d},"delete":function(b){b=t(b,a);-1<b&&(a.splice(b,1),c.splice(b,1),this.size--)},forEach:function(b,d){for(var e=0;e<a.length;e++)b.call(d,c[e],a[e],this)}}},D=f.getOwnPropertyNames?function(){var a=f.getOwnPropertyNames;try{arguments.callee}catch(c){var b=
(a(t).join(" ")+" ").replace(/prototype |length |name /g,"").slice(0,-1).split(" ");b.length&&(a=function(a){var e=f.getOwnPropertyNames(a);if("function"===typeof a){a=0;for(var h;a<b.length;)-1<(h=t(b[a++],e))&&e.splice(h,1)}return e})}return a}():function(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},y=f.getPrototypeOf||null,u=f.defineProperties?f.getOwnPropertyDescriptor:null,A=v.requestAnimationFrame||v.webkitRequestAnimationFrame||function(){var a=+new Date;return function(c){return setTimeout(function(){c(+new Date-
a)},17)}}(),z=function(){var a=u?function(b,a,e,h,c){var g=a.properties[e],f=b[g],q=a.values[e],m=a.descriptors[e];"value"in c&&(q===f?0===q&&1/q!==1/f:q===q||f===f)&&(r(b,a,{name:g,type:"update",object:b,oldValue:q},h),a.values[e]=f);!m.configurable||c.configurable&&c.writable===m.writable&&c.enumerable===m.enumerable&&c.get===m.get&&c.set===m.set||(r(b,a,{name:g,type:"reconfigure",object:b,oldValue:q},h),a.descriptors[e]=c)}:function(b,a,e,c){var f=a.properties[e],g=b[f],n=a.values[e];if(n===g?
0===n&&1/n!==1/g:n===n||g===g)r(b,a,{name:f,type:"update",object:b,oldValue:n},c),a.values[e]=g},c=u?function(b,d,e,c,f){for(var g=d.length,n;e&&g--;)null!==d[g]&&(n=u(b,d[g]),e--,n?a(b,c,g,f,n):(r(b,c,{name:d[g],type:"delete",object:b,oldValue:c.values[g]},f),c.properties.splice(g,1),c.values.splice(g,1),c.descriptors.splice(g,1)))}:function(a,d,c,h,f){for(var g=d.length;c&&g--;)null!==d[g]&&(r(a,h,{name:d[g],type:"delete",object:a,oldValue:h.values[g]},f),h.properties.splice(g,1),h.values.splice(g,
1),c--)};return function(b,d,e){if(b.handlers.size&&!b.frozen){var h,w,g,n=b.values,q=b.descriptors,m=0,k,p,l;if(b.extensible)if(h=b.properties.slice(),w=h.length,g=D(d),q){for(;m<g.length;)p=g[m++],k=t(p,h),l=u(d,p),-1===k?(r(d,b,{name:p,type:"add",object:d},e),b.properties.push(p),n.push(d[p]),q.push(l)):(h[k]=null,w--,a(d,b,k,e,l));c(d,h,w,b,e);f.isExtensible(d)||(b.extensible=!1,r(d,b,{type:"preventExtensions",object:d},e),b.frozen=f.isFrozen(d))}else{for(;m<g.length;)p=g[m++],k=t(p,h),q=d[p],
-1===k?(r(d,b,{name:p,type:"add",object:d},e),b.properties.push(p),n.push(q)):(h[k]=null,w--,a(d,b,k,e));c(d,h,w,b,e)}else if(!b.frozen){for(;m<h.length;m++)p=h[m],a(d,b,m,e,u(d,p));f.isFrozen(d)&&(b.frozen=!0)}y&&(e=y(d),e!==b.proto&&(r(d,b,{type:"setPrototype",name:"__proto__",object:d,oldValue:b.proto}),b.proto=e))}}}(),E=function(){k.size&&(k.forEach(z),l.forEach(B),A(E))},B=function(a,c){a.changeRecords.length&&(c(a.changeRecords),a.changeRecords=[])},F=function(a,c){2>arguments.length&&(c=k.get(a));
return c&&c.notifier||{notify:function(b){b.type;var c=k.get(a);if(c){var e={object:a},h;for(h in b)"object"!==h&&(e[h]=b[h]);r(a,c,e)}},performChange:function(b,c,e){if("string"!==typeof b)throw new TypeError("Invalid non-string changeType");if("function"!==typeof c)throw new TypeError("Cannot perform non-function");var h=k.get(a),f;c=c.call(e);h&&z(h,a,b);if(h&&c&&"object"===typeof c){b={object:a,type:b};for(f in c)"object"!==f&&"type"!==f&&(b[f]=c[f]);r(a,h,b)}}}},G=function(a,c,b,d){var e=l.get(b);
e||l.set(b,e={observed:x(),changeRecords:[]});e.observed.set(a,{acceptList:d.slice(),data:c});c.handlers.set(b,e)},r=function(a,c,b,d){c.handlers.forEach(function(c){var f=c.observed.get(a).acceptList;("string"!==typeof d||-1===t(d,f))&&-1<t(b.type,f)&&c.changeRecords.push(b)})};k=x();l=x();f.observe=function(a,c,b){if(null===a||"object"!==typeof a&&"function"!==typeof a)throw new TypeError("Object.observe cannot observe non-object");if("function"!==typeof c)throw new TypeError("Object.observe cannot deliver to non-function");
if(f.isFrozen&&f.isFrozen(c))throw new TypeError("Object.observe cannot deliver to a frozen function object");J(b)||(b=H);var d=k.get(a);if(d)G(a,d,c,b);else{var d=void 0,e=I(a)?[]:D(a),h=[],l,g=0,d={handlers:x(),frozen:f.isFrozen?f.isFrozen(a):!1,extensible:f.isExtensible?f.isExtensible(a):!0,proto:y&&y(a),properties:e,values:h,notifier:F(a,d)};if(u)for(l=d.descriptors=[];g<e.length;)l[g]=u(a,e[g]),h[g]=a[e[g++]];else for(;g<e.length;)h[g]=a[e[g++]];k.set(a,d);G(a,d,c,b);1===k.size&&A(E)}return a};
f.unobserve=function(a,c){if(null===a||"object"!==typeof a&&"function"!==typeof a)throw new TypeError("Object.unobserve cannot unobserve non-object");if("function"!==typeof c)throw new TypeError("Object.unobserve cannot deliver to non-function");var b=l.get(c),d;if(b&&(d=b.observed.get(a))){b.observed.forEach(function(a,b){z(a.data,b)});A(function(){B(b,c)});if(1===b.observed.size&&b.observed.has(a))l["delete"](c);else b.observed["delete"](a);if(1===d.data.handlers.size)k["delete"](a);else d.data.handlers["delete"](c)}return a};
f.getNotifier=function(a){if(null===a||"object"!==typeof a&&"function"!==typeof a)throw new TypeError("Object.getNotifier cannot getNotifier non-object");return f.isFrozen&&f.isFrozen(a)?null:F(a)};f.deliverChangeRecords=function(a){if("function"!==typeof a)throw new TypeError("Object.deliverChangeRecords cannot deliver to non-function");var c=l.get(a);c&&(c.observed.forEach(function(a,c){z(a.data,c)}),B(c,a))}}(Object,Array,this);
